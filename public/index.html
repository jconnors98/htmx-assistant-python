<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Builders Life TalentCentral Assistant</title>
  <link rel="stylesheet" href="app.css" />
  <script src="https://unpkg.com/htmx.org@1.9.5"></script>
</head>
<body>
  <main class="container">
    <h1>Builders Life TalentCentral Assistant</h1>
    <p class="intro">
      Your one-stop destination for construction jobs and career support in BC. Whether you're just starting out, changing careers, or looking to grow in the construction industry, we connect you with job opportunities, training programs, and resources from the British Columbia Construction Association (BCCA) and its partners.
    </p>

    <div id="chat-box" class="chat-box">
      <!-- Prompt buttons -->
      <details class="prompt-section" open>
        <summary class="prompt-toggle">⬇ Suggestions</summary>
        <div class="prompt-buttons">
          <button hx-post="/ask" hx-target="#chat-box" hx-swap="beforeend" hx-include="[name=message]" onclick="setPrompt('What programs are available?')">What programs are available?</button>
          <button hx-post="/ask" hx-target="#chat-box" hx-swap="beforeend" hx-include="[name=message]" onclick="setPrompt('How do I apply?')">How do I apply?</button>
          <button hx-post="/ask" hx-target="#chat-box" hx-swap="beforeend" hx-include="[name=message]" onclick="setPrompt('Where is the job board?')">Where is the job board?</button>
        </div>
      </details>

      <!-- Messages injected here -->
    </div>

    <!-- Chat form -->
    <form id="chat-form" class="chat-form" hx-post="/ask" hx-target="#chat-box" hx-swap="beforeend" hx-on::after-request="scrollToBottom()">
      <textarea
        id="user-input"
        name="message"
        placeholder="Ask the Assistant about jobs, training programs, or how to apply..."
        required
        autofocus
        onkeydown="if (event.key === 'Enter' && !event.shiftKey) { event.preventDefault(); document.querySelector('#send-button').click(); }"
      ></textarea>

      <div class="chat-buttons">
        <button id="send-button" type="submit">Send</button>
        <button type="button" onclick="clearChat()">Clear Chat</button>
      </div>
    </form>

    <!-- Scroll to top -->
    <button onclick="window.scrollTo({ top: 0, behavior: 'smooth' })" class="scroll-top-btn">⬆ Top</button>
  </main>

  <script>
    function setPrompt(text) {
      const input = document.getElementById("user-input");
      input.value = text;
      document.getElementById("send-button").click();
    }

    function clearChat() {
      document.getElementById("chat-box").innerHTML = '';
      document.getElementById("user-input").value = '';
    }

    function scrollToBottom() {
      const chatBox = document.getElementById("chat-box");
      chatBox.scrollTop = chatBox.scrollHeight;
    }
  </script>
</body>
</html>
